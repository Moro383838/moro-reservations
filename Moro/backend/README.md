# Paradise Getaway Backend API

هذا هو الباك إند لموقع Paradise Getaway للحجوزات، مبني باستخدام Node.js وExpress مع MongoDB كقاعدة بيانات.

## المميزات

- نظام تسجيل وتسجيل دخول المستخدمين مع JWT
- إدارة حجوزات الفندق والمطعم وصالة الأفراح
- التحقق من توفر الأوقات ومنع تداخل الحجوزات
- إمكانية إلغاء الحجوزات

## متطلبات التشغيل

- Node.js (v14 أو أحدث)
- MongoDB (تشغيل محلياً أو استخدام MongoDB Atlas)

## طريقة التشغيل

1. تثبيت التبعيات:
   ```
   npm install
   ```

2. إعداد ملف البيئة:
   قم بإنشاء ملف `.env` في المجلد الرئيسي وأضف المتغيرات التالية:
   ```
   PORT=5000
   MONGODB_URI=mongodb://localhost:27017/paradise-getaway
   JWT_SECRET=your-secret-key
   ```

3. تشغيل الخادم:
   ```
   npm run dev
   ```

## واجهات API

### المصادقة

- **تسجيل مستخدم جديد**
  - POST `/api/auth/register`
  - الحقول المطلوبة: `firstName`, `lastName`, `email`, `password`

- **تسجيل الدخول**
  - POST `/api/auth/login`
  - الحقول المطلوبة: `email`, `password`

### الحجوزات

- **إنشاء حجز جديد**
  - POST `/api/bookings`
  - الحقول المطلوبة: `type`, `date`, `timeStart` (للمطعم وصالة الأفراح), `hours` (للمطعم وصالة الأفراح), `guests`
  - يتطلب توكن المصادقة في الهيدر `x-auth-token`

- **الحصول على حجوزات المستخدم**
  - GET `/api/bookings`
  - يتطلب توكن المصادقة في الهيدر `x-auth-token`

- **إلغاء حجز**
  - PUT `/api/bookings/:id/cancel`
  - يتطلب توكن المصادقة في الهيدر `x-auth-token`

- **التحقق من توفر الأوقات**
  - GET `/api/availability?type=TYPE&date=DATE`
  - استبدل `TYPE` بـ `hotel`, `restaurant`, أو `wedding`
  - استبدل `DATE` بالتاريخ بصيغة `YYYY-MM-DD`

## نظام منع تداخل الحجوزات

يتضمن النظام آلية للتحقق من تداخل الأوقات بحيث لا يمكن للمستخدمين حجز نفس المكان في نفس الوقت. عندما يحجز مستخدم صالة الأفراح أو طاولة في المطعم، يتم التحقق من جميع الحجوزات الموجودة في نفس التاريخ والنوع، ويتم رفض الحجز إذا كان هناك تداخل في الأوقات.

مثال: إذا حجز مستخدم صالة الأفراح من الساعة 12 لمدة 3 ساعات، فلن يتمكن مستخدم آخر من حجز نفس الصالة في أي وقت يتداخل مع هذه الفترة (من 12 إلى 15)، لكن يمكنه الحجز من الساعة 11 إلى 12 أو من الساعة 15 فما بعد.